<section class="container py-5">
  <div class="text-center mb-4">
    <h2 class="fw-bold">Solicitar Turno</h2>
    <p class="text-muted">Seleccioná los filtros para ver la disponibilidad de turnos.</p>
  </div>

  <!-- Filtros -->
  <div class="row mb-4">
    <div class="col">
      <select class="form-select" [(ngModel)]="filtroEspecialidad" (change)="filtrarTurnos()">
        <option value="">Todas las especialidades</option>
        <option *ngFor="let esp of especialidades" [value]="esp">{{esp}}</option>
      </select>
    </div>
    <div class="col">
      <input type="text" class="form-control" placeholder="Nombre del médico"
             [(ngModel)]="filtroMedico" (input)="filtrarTurnos()">
    </div>
    <div class="col">
      <select class="form-select" [(ngModel)]="filtroEntidad" (change)="filtrarTurnos()">
        <option value="">Todas las entidades</option>
        <option *ngFor="let e of entidades" [value]="e">{{e}}</option>
      </select>
    </div>
  </div>

  <!-- Mensaje guía si aún no se filtró -->
  <p *ngIf="!mostrarCalendario" class="text-center text-muted">
    Seleccioná los filtros para ver los días disponibles.
  </p>

  <!-- Mensaje si no hay turnos disponibles -->
  <p *ngIf="mostrarCalendario && eventosFiltrados.length === 0" class="text-center text-danger">
    No hay turnos disponibles
    <span *ngIf="filtroEspecialidad">para la especialidad {{filtroEspecialidad}}</span>
    <span *ngIf="filtroEntidad"> en {{filtroEntidad}}</span>
    <span *ngIf="filtroMedico"> para el médico {{filtroMedico}}</span>.
  </p>

  <!-- Calendario solo si hay eventos -->
  <full-calendar *ngIf="mostrarCalendario && eventosFiltrados.length > 0" [options]="calendarOptions"></full-calendar>

  <!-- Modal de horarios -->
  <div class="modal fade" id="horariosModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Horarios para {{fechaSeleccionada}}</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body text-center">
          <div *ngIf="horariosDisponibles.length > 0; else noHorarios">
            <div class="d-flex justify-content-center gap-2 flex-wrap">
              <button
                *ngFor="let h of horariosDisponibles"
                class="btn"
                [ngClass]="h.disponible ? 'btn-success' : 'btn-danger'"
                [disabled]="!h.disponible"
                (click)="confirmarTurno(h.hora)">
                {{h.hora}}
              </button>
            </div>
          </div>
          <ng-template #noHorarios>
            <p class="text-muted">No hay horarios disponibles.</p>
          </ng-template>
        </div>
      </div>
    </div>
  </div>
</section>