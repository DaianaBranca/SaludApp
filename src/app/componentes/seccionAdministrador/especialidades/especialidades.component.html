<div class="VentanaNivel0">
  <br>
  <h2>Lista de especialidades</h2>

  <div class="especialidades-grid">
    <div *ngFor="let especialidad of especialidadesLocal; let i = index" class="especialidad-card">
      <img [src]="this.prefijoImagen+especialidad.imagen" alt="Logo de especialidad" />

      <div class="info">
        <h3>{{ especialidad.nombre }}</h3>
        <p>Duración: {{ especialidad.duracion }} minutos</p>
      </div>

      <!-- SOLO PARA ADMIN -->
      <ng-container *ngIf="perfilActivo?.rol === 'administrador'">
        <div class="acciones">
          <button class="btn editar" (click)="mostrarPanelEditarEspecialidad(i)">Editar</button>
          <button class="btn eliminar" (click)="eliminarEspecialidad(especialidad)">Eliminar</button>
        </div>

        <!-- Panel de edición -->
        <div *ngIf="mostrarPanelEditar[i]" class="editar-form">
          <label>Nombre:</label>
          <input type="text" [(ngModel)]="especialidadEditada.nombre" />

          <label>Duración (minutos):</label>
          <input type="number" [(ngModel)]="especialidadEditada.duracion" min="1" />

          <button class="btn guardar" (click)="editarEspecialidad()">Guardar</button>
          <button class="btn cancelar" (click)="cerrarPaneles()">Cancelar</button>
        </div>
      </ng-container>
    </div>
  </div>

  <!-- SOLO ADMIN -->
  <ng-container *ngIf="perfilActivo?.rol === 'administrador'">
    <button class="btn agregar" (click)="mostrarPanelNuevaEspecialidad()">Agregar especialidad</button>
    <div *ngIf="mostrarPanelNueva">
      <app-nueva-especialidad></app-nueva-especialidad>
    </div>
  </ng-container>

  <div class="acciones-globales">
    <button class="btn exportar" (click)="exportarCSV()">⬇️ Exportar CSV</button>
  </div>
</div>